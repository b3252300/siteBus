import{_ as U,u as k,r as G,o as J,n as R,E as r,l as n,a as d,c as a,b as i,d as o,e as f,w as O,f as P,g as H,v as j,t as B,h as E,i as V,j as M,k as X,m as z,p as T,q as Y}from"./index-B9shPAHu.js";import"./MapLayout.vue_vue_type_style_index_0_scoped_d1807789_lang-CFDAK7Ip.js";const q="data:image/png;base64,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AAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAAAfAUATKPWTHqFE5X+SP2XKrjYU4sB+MfWTb2P1NdXwcUesQNktxCA6BrbAcjeAGYAEF0VfooegFqqEwA7AAB2AABSawMguy4AolswF4Ds1wAFgOhaATADAhBcBwDZtQBgCAQgt3oAsutsAMAtEACXAAC8BgAgcgYAwAwAgNcAAIQ2uxmA6LoKANG1AOA1AAAuAQCk1gaAWyAAudV1ApA9AswCwCUAAJcAAEJrB8ARAIDXAACk1glAdI2OgOy66gCIrrkAYAQAILdWAOwAANgBAEhtEQDRNc0BwAgAgBEAgNDaAQAAgOBaAMiuC4Do6t0Cwm+BDQBE11YAiK4DgOxaAQifAQAwAwBgBwAgtNnNAES3qAAQXQsA2bUD4BIAAAAAuAUCkFjdQgCyT4CZALgEAJBbKwDZdQDgCADAawAAUlsIQHSNjoDsqvUfhE1HACsmvcKutRX+SK89OdkVZhUAbrclk17hfMXvcEum9DfmCAgPAAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAAIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACAAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAqun+BGTO3BD4YxcdAAAAAElFTkSuQmCC",Z={class:"login-overlay"},K={class:"login-steps"},$={class:"step-box"},AA={id:"google_btn_wrapper",class:"center-flex"},lA={key:0,class:"authenticated-info"},eA={class:"success-text"},oA={class:"step-box"},tA={key:0},sA={key:1,class:"authenticated-info"},nA={class:"success-text"},fA={class:"step-box"},iA={key:0},cA={key:1,class:"authenticated-info"},aA={class:"success-text"},OA={__name:"LoginCard",emits:["login-success"],setup(h,{emit:u}){const t=k(),g="737444360335-03fp8kjs1alt73gi9dnr700ki5j12uhc.apps.googleusercontent.com",I="1943332376223447",_="2008860930-zwC6uFAG";console.log("GOOGLE_CLIENT_ID:","✓ 已載入"),console.log("FB_APP_ID:","✓ 已載入"),console.log("LINE_LIFF_ID:","✓ 已載入");const b=u,e=G({google:{id:null,name:null,picture:null},facebook:{id:null,name:null,picture:null},line:{id:null,name:null,picture:null}});J(()=>{Q(),S(),v(),F()});const Q=()=>{t.user&&(t.user.google&&(e.google=t.user.google),t.user.facebook&&(e.facebook=t.user.facebook),t.user.line&&(e.line=t.user.line))},S=()=>{if(window.google&&window.google.accounts)w();else{const A=document.createElement("script");A.src="https://accounts.google.com/gsi/client",A.async=!0,A.defer=!0,A.onload=()=>{w()},document.head.appendChild(A)}},w=()=>{window.google.accounts.id.initialize({client_id:g,callback:D}),R(()=>{const A=document.getElementById("google_btn_wrapper");A&&window.google.accounts.id.renderButton(A,{theme:"outline",size:"large",text:"signin_with",shape:"rectangular",logo_alignment:"left",width:250})})},D=A=>{const l=JSON.parse(decodeURIComponent(escape(atob(A.credential.split(".")[1]))));e.google={id:l.sub,name:l.name,picture:l.picture},p(),r.success(`Google 登入成功: 歡迎 ${l.name}`)},v=()=>{window.FB||(window.fbAsyncInit=function(){window.FB.init({appId:I,cookie:!0,xfbml:!0,version:"v24.0"}),window.FB.AppEvents.logPageView()},(function(A,l,c){var s,W=A.getElementsByTagName(l)[0];A.getElementById(c)||(s=A.createElement(l),s.id=c,s.src="https://connect.facebook.net/en_US/sdk.js",W.parentNode.insertBefore(s,W))})(document,"script","facebook-jssdk"))},N=()=>{window.FB&&window.FB.login(A=>{A.authResponse?window.FB.api("/me",{fields:"name, picture"},l=>{e.facebook={id:l.id,name:l.name,picture:l.picture.data.url},p(),r.success(`Facebook 登入成功: ${l.name}`)}):r.warning("Facebook 登入取消")},{scope:"public_profile"})},C=async()=>{try{await n.init({liffId:_}),n.isLoggedIn()&&await m()}catch(A){console.error("LIFF Initialization failed",A)}},F=()=>{if(n){C();return}const A=document.createElement("script");A.src="https://static.line-scdn.net/liff/edge/2/sdk.js",A.async=!0,A.onload=()=>{C()},document.head.appendChild(A)},L=()=>{n&&(n.isLoggedIn()?m():n.login())},m=async()=>{try{const A=await n.getProfile();console.log(A,"profile"),e.line={id:A.userId,name:A.displayName,picture:A.pictureUrl},p(),r.success(`LINE 登入成功: ${A.displayName}`)}catch(A){console.error("Error getting profile",A)}},y=()=>{V.push({path:"/mapRoute"})};function p(){t.setUser({google:e.google,facebook:e.facebook,line:e.line}),b("login-success",{google:e.google,facebook:e.facebook,line:e.line})}return(A,l)=>{const c=d("el-avatar"),s=d("el-button"),W=d("el-link"),x=d("el-card");return i(),a("div",Z,[l[4]||(l[4]=o("div",{class:"bg-overlay"},null,-1)),f(x,{class:"login-card",shadow:"never"},{header:O(()=>[...l[0]||(l[0]=[o("h2",{class:"title-header",style:{"text-align":"center",margin:"0"}}," 登入 ",-1)])]),default:O(()=>[o("div",K,[o("div",$,[P(o("div",AA,null,512),[[j,!e.google.id]]),e.google.id?(i(),a("div",lA,[f(c,{src:e.google.picture},null,8,["src"]),o("span",eA,"Google 已驗證: "+B(e.google.name),1)])):H("",!0)]),o("div",oA,[e.facebook.id?(i(),a("div",sA,[f(c,{src:e.facebook.picture},null,8,["src"]),o("span",nA,"Facebook 已綁定: "+B(e.facebook.name),1)])):(i(),a("div",tA,[f(s,{class:"btn-facebook",size:"large",onClick:N,style:{width:"250px","border-radius":"4px"}},{default:O(()=>[...l[1]||(l[1]=[o("img",{src:q,alt:"FB"},null,-1),E(" Facebook ",-1)])]),_:1})]))]),o("div",fA,[e.line.id?(i(),a("div",cA,[f(c,{src:e.line.picture},null,8,["src"]),o("span",aA,"LINE 已綁定: "+B(e.line.name),1)])):(i(),a("div",iA,[f(s,{class:"btn-line",size:"large",onClick:L,style:{width:"250px","border-radius":"4px","background-color":"#06C755",color:"white",border:"none"}},{default:O(()=>[...l[2]||(l[2]=[o("img",{src:"https://upload.wikimedia.org/wikipedia/commons/4/41/LINE_logo.svg",style:{height:"20px","margin-right":"8px"},alt:"LINE"},null,-1),E(" LINE 登入 ",-1)])]),_:1})]))]),f(W,{underline:"hover",onClick:y},{default:O(()=>[...l[3]||(l[3]=[E("返回",-1)])]),_:1})])]),_:1})])}}},gA=U(OA,[["__scopeId","data-v-6f7e82b2"]]),dA=M({__name:"LoginView",setup(h){const u=T();k(),X(null);const t=g=>{g&&(u.push({path:"/mapRoute"}),Y({title:"登入成功",message:"即將進入查詢地圖...",type:"success"}))};return(g,I)=>(i(),z(gA,{onLoginSuccess:t}))}});export{dA as default};
